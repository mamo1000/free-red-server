
  # تحميل وفك ضغط ngrok
  Invoke-WebRequest https://bin.equinox.io/c/bNyj1mQVY4c/ngrok-stable-windows-amd64.zip -OutFile ngrok.zip
  Expand-Archive ngrok.zip -DestinationPath ngrok

  # تحديد المسار الصحيح لـ ngrok.exe
  $ngrokPath = Join-Path (Get-Location).Path "ngrok\ngrok.exe"

  # مصادقة ngrok
  & $ngrokPath authtoken $env:NGROK_AUTH_TOKEN

  # إنشاء مستخدم جديد وإضافته للمجموعات
  net user kamel123 MyStrong123 /add
  net localgroup "Remote Desktop Users" kamel123 /add
  net localgroup administrators kamel123 /add

  # تفعيل RDP وفتح البورت
  Set-ItemProperty -Path 'HKLM:\System\CurrentControlSet\Control\Terminal Server' -Name 'fDenyTSConnections' -Value 0
  Enable-NetFirewallRule -DisplayGroup "Remote Desktop"

  # تشغيل نفق ngrok
  & $ngrokPath tcp 3389
